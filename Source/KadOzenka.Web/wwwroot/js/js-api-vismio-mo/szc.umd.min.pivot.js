(("undefined"!==typeof self?self:this)["webpackJsonpszc"]=("undefined"!==typeof self?self:this)["webpackJsonpszc"]||[]).push([[11],{"035d":function(e,t,r){"use strict";r.r(t);var o=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("DxPivotGridFieldChooser",e._b({},"DxPivotGridFieldChooser",e.options,!1))},n=[],i=r("f8a2"),a=r.n(i),_=r("1284"),s={name:"PivotGridFieldChooser",mixins:[_["a"]],components:{DxPivotGridFieldChooser:a.a}},c=s,l=r("2877"),u=Object(l["a"])(c,o,n,!1,null,null,null);t["default"]=u.exports},"054b":function(e,t,r){"use strict";r.r(t);var o=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"pivot-grid-data-source"},[r("span",{staticClass:"pivot-grid-data-source__text"},[e._v("\n    "+e._s(e.options.text||e.options.dataSetName)+" ("+e._s(e.componentId)+")\n  ")])])},n=[],i=(r("8e6e"),r("cadf"),r("456d"),r("53ca")),a=(r("96cf"),r("1da1")),_=(r("ac6a"),r("55dd"),r("ade3")),s=r("a83e"),c=r("1284"),l=r("6b39"),u=r("bf8c");function d(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function p(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?d(Object(r),!0).forEach((function(t){Object(_["a"])(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):d(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var f={name:"PivotGridDataSource",mixins:[c["a"]],computed:{defaultParam:function(){return this.options.defaultParam||{}},colorFields:function(){return this.options.colorFields||[]}},created:function(){this.dataSource=null,this.storeLoadResult=null,this.param=null},mounted:function(){this.$emit("initialized",this)},methods:{initDataSource:function(){var e=this;this.dataSource=new s["a"]({remoteOperations:!0,fields:this.options.fields||[],load:function(t){var r=!1;if(t.filter){var o=t.filter.indexOf("geo_data_refresh");-1!==o&&(r=!0,Array.isArray(t.filter)?(t.filter.splice(o-1,2),t.filter=t.filter[0]):t.filter=null)}var n=p(p(p({},e.defaultParam),e.param),{},{_config_is_olap:!0,_config_serverside:!0,_config_geo_data_refresh:r,take:t.take,skip:t.skip,group:t.group||[],filter:t.filter||[],sort:t.sort||null,orderby:t.sort||null,totalSummary:t.totalSummary||[],groupSummary:t.groupSummary||[],_config_dataset:e.options.dataSetName});return e.colorFields.forEach((function(e){n.groupSummary.push({selector:e.dataField,summaryType:e.summaryType||"count"}),e.dataIndex=n.groupSummary.length-1})),Object(u["c"])("getData",n).then((function(e){return{data:e.data,totalCount:t.skip+t.take}}))}}),this.$store.dispatch("config/setItemFields",{componentId:this.componentId,fields:[{name:"dataSource",value:this.dataSource}]})},refreshData:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.param=t||{},this.dataSource){e.next=5;break}this.initDataSource(),e.next=6;break;case 5:return e.abrupt("return",this.dataSource.reload());case 6:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),deleteData:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){var r=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(l["e"])(this.options.dataSetName,t).then((function(e){return r.dataSource.reload().then((function(){return r.callEventAction(r.componentId,"onAfterDelete",e),e}))})));case 1:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),setFields:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t&&"object"===Object(i["a"])(t)){e.next=2;break}return e.abrupt("return");case 2:if(this.$store.dispatch("config/setComponentOption",{componentId:this.componentId,optionName:"colorFields",optionValue:t.color_fields||[]}),Array.isArray(t.fields)){e.next=5;break}return e.abrupt("return");case 5:this.dataSource.fields(t.fields);case 6:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()}},m=f,h=(r("5da6"),r("2877")),b=Object(h["a"])(m,o,n,!1,null,null,null);t["default"]=b.exports},"17bc":function(e,t,r){"use strict";r.r(t);var o=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("DxPivotGrid",e._b({ref:"dxComponent",staticClass:"pivot-grid",on:{initialized:e.subscribeToDataSetOnInit,cellClick:e.onCellClick,cellPrepared:e.onCellPrepared}},"DxPivotGrid",e.options,!1))},n=[],i=r("699b"),a=i["a"],_=(r("48fc"),r("2877")),s=Object(_["a"])(a,o,n,!1,null,null,null);t["default"]=s.exports},"48fc":function(e,t,r){"use strict";var o=r("a953"),n=r.n(o);n.a},"5da6":function(e,t,r){"use strict";var o=r("83ef"),n=r.n(o);n.a},"699b":function(module,__webpack_exports__,__webpack_require__){"use strict";var core_js_modules_es7_object_get_own_property_descriptors__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("8e6e"),core_js_modules_es7_object_get_own_property_descriptors__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(core_js_modules_es7_object_get_own_property_descriptors__WEBPACK_IMPORTED_MODULE_0__),core_js_modules_es6_object_keys__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("456d"),core_js_modules_es6_object_keys__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(core_js_modules_es6_object_keys__WEBPACK_IMPORTED_MODULE_1__),core_js_modules_web_dom_iterable__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("ac6a"),core_js_modules_web_dom_iterable__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(core_js_modules_web_dom_iterable__WEBPACK_IMPORTED_MODULE_2__),core_js_modules_es6_array_iterator__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("cadf"),core_js_modules_es6_array_iterator__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(core_js_modules_es6_array_iterator__WEBPACK_IMPORTED_MODULE_3__),C_Users_Documents_Projects_platform_js_api_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("ade3"),devextreme_vue_pivot_grid__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("61f7"),devextreme_vue_pivot_grid__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(devextreme_vue_pivot_grid__WEBPACK_IMPORTED_MODULE_5__),_mixins_options__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("1284"),_mixins_data__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("7bf0");function ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(r),!0).forEach((function(t){Object(C_Users_Documents_Projects_platform_js_api_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_4__["a"])(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var DBL_CLICK_INTERVAL=500;__webpack_exports__["a"]={name:"PivotGrid",mixins:[_mixins_options__WEBPACK_IMPORTED_MODULE_6__["a"],_mixins_data__WEBPACK_IMPORTED_MODULE_7__["b"]],components:{DxPivotGrid:devextreme_vue_pivot_grid__WEBPACK_IMPORTED_MODULE_5___default.a},data:function(){return{dxComponent:null,$focusedCellElement:null,clickCount:0,clickTarget:0,lastClickTime:null,isDblClick:!1}},computed:{colorFields:function(){return this.options.colorFields||[]}},created:function(){this.dxComponent=this.$refs.dxComponent},methods:{subscribeToDataSetOnInit:function(){var e=this;this.dataSetComponentId&&(this.$watch((function(){return e.$store.getters["config/getItemField"](e.dataSetComponentId,"dataSource")}),(function(t){t&&window.setTimeout((function(){e.$store.dispatch("config/setComponentOption",{componentId:e.componentId,optionName:"dataSource",optionValue:t})}),1)})),this.$watch((function(){return e.$store.getters["config/getComponentOptions"](e.dataSetComponentId).colorFields}),(function(t){t&&window.setTimeout((function(){e.$store.dispatch("config/setComponentOption",{componentId:e.componentId,optionName:"colorFields",optionValue:t})}),1)})))},onCellPrepared:function(e){var t=this;if(e.cellElement&&(e.cellElement.mouseover=function(r){var o=_objectSpread(_objectSpread({},r),e);t.callEventAction(t.componentId,"onCellMouseOver",o)},e.cellElement.mouseout=function(r){var o=_objectSpread(_objectSpread({},r),e);t.callEventAction(t.componentId,"onCellMouseOut",o)}),"data"===e.area&&"D"===e.cell.rowType&&"D"===e.cell.columnType){var r=this.dxComponent.instance.getDataSource().getAreaFields("data")[e.cell.dataIndex];this.useCellStyle(r,e);var o=this.dxComponent.instance.getDataSource().getData();if(o&&Array.isArray(this.colorFields)&&this.colorFields.length>0){var n=_objectSpread({},e),i=n.cell,a=i.rowPath,_=i.columnPath,s=this.getItemByPath(a,o.rows),c=this.getItemByPath(_,o.columns);if(s&&c){var l=s.index,u=c.index,d=o.values[l];void 0!==d&&void 0!==d[u]&&this.colorFields.forEach((function(e){var r=e.dataIndex,i=o.values[l][u][r];n.cell.value=i,t.useCellStyle(e,n)}))}}}},getItemByPath:function(e,t){var r=this,o=e.shift();(t||[]).forEach((function(t){if(t.value===o)return e.length>0&&Array.isArray(t.children)?r.getItemByPath(e,t.children):t}))},useCellStyle:function(e,t){var r=this,o=e.cellStyles||[];o.forEach((function(e){var o=e.cssStyle,n=e.expression;o&&n&&r.applyCellStyle(o,n,t.cellElement)}))},applyCellStyle:function(e,t,r){this.evalCellStyleExpression(t)&&Object.keys(e).forEach((function(t){r.style[t]=e[t]}))},evalCellStyleExpression:function evalCellStyleExpression(expression){var evalResult=!1;try{evalResult=eval(expression)}catch(err){window.console.warn("PivotGird. ошибка в expression для стиля ячейки",err)}return evalResult},onCellClick:function(e){if(this.dxComponent){if("data"===e.area){var t="pivot-grid__cell-focused";this.$focusedCellElement&&this.$focusedCellElement.classList.remove(t),this.$focusedCellElement=e.cellElement,this.$focusedCellElement.classList.add(t)}var r=this.dxComponent.instance.getDataSource(),o=r.createDrillDownDataSource(e.cell),n={cell:e.cell,drillDownDataSource:o,pivotGrid:this};this.detectDblClick(e.cell)?this.callEventAction(this.componentId,"onCellDblClick",n):this.callEventAction(this.componentId,"onCellClick",n)}},detectDblClick:function(e){var t=this,r=!1;if(this.clickCount?this.clickTarget===e?this.clickCount++:this.resetDblClickData():(this.clickCount=1,this.clickTarget=e),1===this.clickCount)this.lastClickTime=(new Date).getTime(),window.setTimeout((function(){t.resetDblClickData()}),DBL_CLICK_INTERVAL);else if(2===this.clickCount&&this.clickTarget===e){var o=(new Date).getTime();o-this.lastClickTime<DBL_CLICK_INTERVAL+50&&(r=!0),this.resetDblClickData()}return r},resetDblClickData:function(){this.clickCount=0,this.clickTarget=0,this.lastClickTime=null}}}},"83ef":function(e,t,r){},a953:function(e,t,r){}}]);