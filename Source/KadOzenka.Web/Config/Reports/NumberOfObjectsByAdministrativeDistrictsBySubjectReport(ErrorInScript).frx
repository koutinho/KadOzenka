<?xml version="1.0" encoding="utf-8"?>
<Report ScriptLanguage="CSharp" ReportInfo.Created="12/24/2019 10:00:00" ReportInfo.Modified="05/28/2020 09:41:47" ReportInfo.CreatorVersion="2017.4.7.0">
  <ScriptText>
using System;
using System.Collections;
using System.Collections.Generic;
using System.ComponentModel;
using System.Windows.Forms;
using System.Drawing;
using System.Data;
using FastReport;
using FastReport.Data;
using FastReport.Dialog;
using FastReport.Barcode;
using FastReport.Table;
using FastReport.Utils;

namespace FastReport
{
  public class ReportScript
  {

    // method called in the Matrix object, in the AfterData event
    private void MatrixData_AfterData(object sender, EventArgs e)
    {
      // remove the AfterData method from the ResultTable object, if it had been assigned earlier
      MatrixData.ResultTable.AfterData -= MatrixDataResultTable_AfterData;
      // assign the AfterData method for the ResultTable object
      MatrixData.ResultTable.AfterData += MatrixDataResultTable_AfterData;
    }
    
    private void MatrixDataResultTable_AfterData(object sender, EventArgs e)
    {
      // get the sender results table
      TableResult table = sender as TableResult;
 
        
      // ------------------- new line with the column numeration ---------
      TableRow newRow = new TableRow();
      // add a row to the results table
      table.Rows.Insert(1, newRow);
      // go through all the cells of the new row
      for (int i = 0; i &lt; table.ColumnCount; i++)
      {
        // set style for the new cells, using the style of the top left cell
        table[i, 1].SetStyle(table[0,0]);
        // set text (# - for the first column and numbers for the others)
        table[i, 1].Text = i == 0 ? &quot;#&quot; : i.ToString();
      }
         
      // ------------------- new column with numeration -------------------
      TableColumn newColumn = new TableColumn();
      // add a new column to the results table
      table.Columns.Insert(1, newColumn);
      // go through all the cells of the new column
      for (int i = 0; i &lt; table.RowCount; i++)
      {
        // set style for the new cells, using the style of the top left cell
        table[1, i].SetStyle(table[0,0]);
        // set text for each cell except for the first one (this is the header, leave it empty)
        if (i &gt; 1)
          table[1, i].Text = (i - 1).ToString();
      }
       
      // increase the number of fixed column by 1
      table.FixedColumns = 2;
      table.FixedRows = 2;
       
    }


  }
}
  </ScriptText>
  <Dictionary>
    <BusinessObjectDataSource Name="Data" ReferenceName="Data" DataType="null" Enabled="true">
      <Column Name="PropertyType" DataType="System.String"/>
      <Column Name="Group" DataType="System.String"/>
      <Column Name="ObjectsCount" DataType="System.Decimal"/>
    </BusinessObjectDataSource>
  </Dictionary>
  <ReportPage Name="Page1" Landscape="true" PaperWidth="297" PaperHeight="210" RawPaperSize="9" Guides="7.56,505.15,9.45,405.5,121.37,181.65,233.3">
    <DataBand Name="BandCommon" Width="1047.06" Height="85.05" CanGrow="true" Guides="28.35,85.05">
      <TextObject Name="TitleText" Left="7.56" Top="28.35" Width="497.59" Height="56.7" CanGrow="true" BeforePrintEvent="BandCommon_BeforePrint" Text="[Common.Title]" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 12pt, style=Bold"/>
    </DataBand>
    <DataBand Name="BandData1" Top="89.05" Width="1047.06" Height="212.41" AfterDataEvent="MatrixData_AfterData" Guides="0,90.88,22.72,45.44,68.16">
      <MatrixObject Name="MatrixData" Left="9.45" Width="396.05" Height="90.88" Border.Lines="All" AfterDataEvent="MatrixData_AfterData" FixedRows="2" FixedColumns="1" RepeatHeaders="false" DataSource="Data" ShowTitle="true">
        <MatrixColumns>
          <Header Expression="[Data.Group]" TotalsFirst="true"/>
        </MatrixColumns>
        <MatrixRows>
          <Header Expression="[Data.PropertyType]"/>
        </MatrixRows>
        <MatrixCells>
          <Cell Expression="[Data.ObjectsCount]"/>
        </MatrixCells>
        <TableColumn Name="Column1" Width="111.92" AutoSize="true"/>
        <TableColumn Name="Column2" Width="111.93" AutoSize="true"/>
        <TableColumn Name="Column3" Width="172.2" AutoSize="true"/>
        <TableRow Name="Row1" Height="22.72" AutoSize="true">
          <TableCell Name="Cell1" Border.Lines="All" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 12pt"/>
          <TableCell Name="Cell7" Border.Lines="All" Text="Количество объектов недвижимости" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 12pt, style=Bold" ColSpan="2"/>
          <TableCell Name="Cell9"/>
        </TableRow>
        <TableRow Name="Row2" Height="22.72" AutoSize="true">
          <TableCell Name="Cell3" Border.Lines="All" Text="Тип объекта" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 12pt, style=Bold"/>
          <TableCell Name="Cell8" Border.Lines="All" Text="[Group]" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 12pt"/>
          <TableCell Name="Cell10" Border.Lines="All" Text="Всего" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 12pt"/>
        </TableRow>
        <TableRow Name="Row3" Height="22.72" AutoSize="true">
          <TableCell Name="Cell5" Border.Lines="All" Text="[PropertyType]" VertAlign="Center" Font="Times New Roman, 12pt"/>
          <TableCell Name="Cell6" Border.Lines="All" Text="[ObjectsCount]" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 12pt"/>
          <TableCell Name="Cell11" Border.Lines="All" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 12pt"/>
        </TableRow>
        <TableRow Name="Row4" Height="22.72" AutoSize="true">
          <TableCell Name="Cell12" Border.Lines="All" Text="Итого" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 12pt"/>
          <TableCell Name="Cell13" Border.Lines="All" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 12pt"/>
          <TableCell Name="Cell14" Border.Lines="All" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 12pt"/>
        </TableRow>
      </MatrixObject>
    </DataBand>
    <ReportSummaryBand Name="ReportSummary1" Top="305.46" Width="1047.06" Height="47.25"/>
  </ReportPage>
</Report>
