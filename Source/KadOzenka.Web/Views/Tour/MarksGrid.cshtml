@model KadOzenka.Web.Models.Tour.TourModel

<div class="form-horizontal col-sm-12">
    <div style="display: flex;">
        <div id="markGrid"></div>
    </div>
</div>

<script>
    $(document).ready(function () {

        var markGridDataSource = new kendo.data.DataSource({
            transport: {
                read: {
                    url: '@Url.Action("GetMarkCatalog", "Tour")',
                    contentType: 'application/json; charset=utf-8',
                    data: {
                        groupId: '@ViewBag.GroupId', factorId: '@ViewBag.FactorId' },
                    dataType: 'json'
                },
                create: {
                    url: '@Url.Action("CreateMark", "Tour")',                         
                    type: 'POST',
                    dataType: 'json'
                },
                update: {
                    url: '@Url.Action("UpdateMark", "Tour")',                    
                    type: 'POST',
                    dataType: 'json'
                },
                destroy: {
                    url: '@Url.Action("DeleteMark", "Tour")',                        
                    type: 'POST',
                    dataType: 'json'
                }
            },             
            schema: {
                model: {
                    id: "Id",
                    fields: {
                        Id: { editable: false, nullable: true },
                        GroupId: { editable: false},
                        FactorId: { editable: false },
                        ValueFactor: { validation: { required: true } },
                        MetkaFactor: { validation: { required: true } }
                    }
                }
            }, 
            pageSize: 10
        });

        $('#markGrid').kendoGrid({
            dataSource: markGridDataSource,
            columns: [
                {
                    field: 'ValueFactor',
                    title: 'Значение',
                    headerAttributes: {                            
                        style: "text-align: center;"
                    }
                }, {
                    field: 'MetkaFactor',
                    title: 'Метка',
                    headerAttributes: {
                        style: "text-align: center;"
                    }
                },
                { command: ["edit", "destroy"], title: "&nbsp;", width: "250px" }
            ],
            toolbar: ["create"],
            scrollable: true,
            pageable: true,
            editable: "inline",
            beforeEdit: function (e) {
                if (e.model.isNew()) {
                    e.model.GroupId = '@ViewBag.GroupId';
                    e.model.FactorId = '@ViewBag.FactorId';
                }
            }
        });

    });

</script>

