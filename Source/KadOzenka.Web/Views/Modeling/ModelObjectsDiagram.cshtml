@model List<KadOzenka.Web.Models.Modeling.ModelingObjectsDiagramModel>

<div class="form-horizontal col-sm-12">
    <div class="form-group">
        @(Html.Kendo().Chart(Model.Take(10))
            .Name("chart")
            .Title("Цена аналогов, включенных в моделирование")
            .Legend(legend => legend.Position(ChartLegendPosition.Bottom))
            .Series(series =>
            {
                series.Line(model => model.Price, model => model.Id)
                    .Name("Цена за кв.м.")
                    .Markers(m => m.Size(15));
            })
            .CategoryAxis(x => x.Visible(false))
            .Events(x => x.SeriesClick("excludeObjectFromCalculation")))
    </div>
</div>





<style>

</style>





<script src="~/js/common-modals.js"></script>
<script src="~/js/custom-validation.js"></script>
<script>

    $(document).ready(function () {

    });



    function excludeObjectFromCalculation(chartPoint) {
        Common.UI.ShowConfirm({
            title: 'Исключение из расчёта',
            content: `Исключить объект с ценой '${chartPoint.value}' из расчёта?`,
            onSuccess: function () {
                kendo.ui.progress($('body'), true);
                $.ajax({
                    url: '@Url.Action("ExcludeObjectFromCalculation", "Modeling")',
                    type: 'POST',
                    data: { objectId: chartPoint.category },
                    success: function () {
                        Common.ShowMessage("Объект исключен");
                    },
                    error: function (response) {
                        Common.ShowError(response.responseText);
                    },
                    complete: function() {
                        kendo.ui.progress($('body'), false);
                    }
                });
            }
        });
    }

</script>

