<Project Sdk="Microsoft.NET.Sdk.Web">

  <PropertyGroup Label="Globals">
    <SccProjectName>SAK</SccProjectName>
    <SccProvider>SAK</SccProvider>
    <SccAuxPath>SAK</SccAuxPath>
    <SccLocalPath>SAK</SccLocalPath>
	<Configurations>Debug;Release;QA;Demo</Configurations>
  </PropertyGroup>

  <PropertyGroup>
    <TargetFramework>netcoreapp2.1</TargetFramework>
  </PropertyGroup>

  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Debug|AnyCPU'">
  	<PlatformTarget>x64</PlatformTarget>
  	<DefineConstants>DEBUG;TRACE</DefineConstants>
  	<EnvironmentName>Development</EnvironmentName>
  	<ASPNETCORE_ENVIRONMENT>Development</ASPNETCORE_ENVIRONMENT>
  </PropertyGroup>
  
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='QA|AnyCPU'">
  	<PlatformTarget>AnyCPU</PlatformTarget>
  	<DefineConstants>DEBUG;TRACE</DefineConstants>
  	<EnvironmentName>QA</EnvironmentName>
  	<ASPNETCORE_ENVIRONMENT>QA</ASPNETCORE_ENVIRONMENT>
  </PropertyGroup>
  
  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Demo|AnyCPU'">
  	<PlatformTarget>AnyCPU</PlatformTarget>
  	<DefineConstants>DEBUG;TRACE</DefineConstants>
  	<EnvironmentName>Demo</EnvironmentName>
  	<ASPNETCORE_ENVIRONMENT>Demo</ASPNETCORE_ENVIRONMENT>
  </PropertyGroup>
  
  <ItemGroup>
    <Content Remove="appsettings.json" />
    <Content Remove="appsettings.Development.json" />
    <Content Remove="appsettings.QA.json" />
    <Content Remove="appsettings.Demo.json" />
    <Content Remove="appsettings.Production.json" />
  </ItemGroup>
  
  <ItemGroup>
	  <None Include="appsettings.json">
	    <CopyToOutputDirectory>PreserveNewest</CopyToOutputDirectory>
	  </None>
	  <None Include="appsettings.Development.json">
		  <CopyToOutputDirectory>Never</CopyToOutputDirectory>
	  </None>
	  <None Include="appsettings.QA.json">
		  <CopyToOutputDirectory>Never</CopyToOutputDirectory>
	  </None>
	  <None Include="appsettings.Demo.json">
		  <CopyToOutputDirectory>Never</CopyToOutputDirectory>
      </None>
	  <None Include="appsettings.Production.json">
		<CopyToOutputDirectory>Never</CopyToOutputDirectory>
	  </None>
  </ItemGroup>
  
  <!--<ItemGroup>
	  <Folder Include="Config\Reports\" />
  </ItemGroup>-->

  <ItemGroup>
    <PackageReference Include="Microsoft.AspNetCore.App" />
    <PackageReference Include="Microsoft.AspNetCore.Razor.Design" Version="2.1.2" PrivateAssets="All" />
    <PackageReference Include="Platform.Web" Version="1.0.685" />
    <PackageReference Include="Serilog.AspNetCore" Version="3.4.0" />
    <PackageReference Include="Serilog.Enrichers.AspnetcoreHttpcontext" Version="1.1.0" />
    <PackageReference Include="Serilog.Enrichers.Context" Version="4.2.0" />
    <PackageReference Include="Serilog.Enrichers.Environment" Version="2.1.3" />
    <PackageReference Include="Serilog.Enrichers.Memory" Version="1.0.4" />
    <PackageReference Include="Serilog.Enrichers.Process" Version="2.0.1" />
    <PackageReference Include="Serilog.Enrichers.Thread" Version="3.1.0" />
    <PackageReference Include="Serilog.Sinks.Seq" Version="4.0.0" />
  </ItemGroup>

  <ItemGroup>
    <ProjectReference Include="..\KadOzenka.Dal\KadOzenka.Dal.csproj" />
  </ItemGroup>

  <ItemGroup>
    <None Update="Config\Param\*">
	    <CopyToOutputDirectory>Always</CopyToOutputDirectory>
    </None>
	<None Update="Config\Reports\*">
		<CopyToOutputDirectory>Always</CopyToOutputDirectory>
	</None>
	<None Update="Config\SqlQueries\**\*">
		<CopyToOutputDirectory>Always</CopyToOutputDirectory>
	</None>
	<None Update="Config\ExcelTemplates\*">
		<CopyToOutputDirectory>Always</CopyToOutputDirectory>
	</None>
  </ItemGroup>

 

  <Target Name="PreBuild" BeforeTargets="PreBuildEvent">
    <Exec Command="attrib -r &quot;$(ProjectDir)Config\*.*&quot; /s&#xD;&#xA;attrib -r &quot;$(ProjectDir)ConfigCore\*.*&quot; /s&#xD;&#xA;attrib -r &quot;$(ProjectDir)wwwroot\*.*&quot; /s" />
  </Target>
	  	<Choose>
		<When Condition=" '$(Configuration)'=='Debug' ">
			<PropertyGroup>
				<DebugSymbols>true</DebugSymbols>
				<DebugType>full</DebugType>
				<Optimize>false</Optimize>
				<OutputPath>.\bin\Debug\</OutputPath>
				<DefineConstants>DEBUG;TRACE</DefineConstants>
				<EnvironmentName>Development</EnvironmentName>
				<ASPNETCORE_ENVIRONMENT>Development</ASPNETCORE_ENVIRONMENT>
				<CopyOutputSymbolsToPublishDirectory>true</CopyOutputSymbolsToPublishDirectory>
			</PropertyGroup>
			<ItemGroup>
				<None Include="appsettings.Development.json" CopyToPublishDirectory="PreserveNewest" />
			</ItemGroup>
		</When>
		<When Condition=" '$(Configuration)'=='QA' ">
			<PropertyGroup>
				<DebugSymbols>true</DebugSymbols>
				<DebugType>full</DebugType>
				<Optimize>false</Optimize>
				<OutputPath>.\bin\QA\</OutputPath>
				<DefineConstants>DEBUG;TRACE</DefineConstants>
				<EnvironmentName>QA</EnvironmentName>
				<ASPNETCORE_ENVIRONMENT>QA</ASPNETCORE_ENVIRONMENT>
				<CopyOutputSymbolsToPublishDirectory>true</CopyOutputSymbolsToPublishDirectory>
				
			</PropertyGroup>
			<ItemGroup>
				<None Include="appsettings.QA.json" CopyToPublishDirectory="PreserveNewest" />
			</ItemGroup>
			
		</When>
		<When Condition=" '$(Configuration)'=='Demo' ">
			<PropertyGroup>
				<DebugSymbols>false</DebugSymbols>
				<DebugType>None</DebugType>
				<Optimize>true</Optimize>
				<OutputPath>.\bin\Demo\</OutputPath>
				<EnvironmentName>Demo</EnvironmentName>
				<ASPNETCORE_ENVIRONMENT>Demo</ASPNETCORE_ENVIRONMENT>
				<CopyOutputSymbolsToPublishDirectory>false</CopyOutputSymbolsToPublishDirectory>
			</PropertyGroup>
			<ItemGroup>
				<None Include="appsettings.Demo.json" CopyToPublishDirectory="PreserveNewest" />
			</ItemGroup>
		</When>
		<When Condition=" '$(Configuration)'=='Release' ">
			<PropertyGroup>
				<DebugSymbols>false</DebugSymbols>
				<DebugType>None</DebugType>
				<Optimize>true</Optimize>
				<EnvironmentName>Production</EnvironmentName>
				<ASPNETCORE_ENVIRONMENT>Production</ASPNETCORE_ENVIRONMENT>
				<CopyOutputSymbolsToPublishDirectory>false</CopyOutputSymbolsToPublishDirectory>
			</PropertyGroup>
			<ItemGroup>
				<None Include="appsettings.Production.json" CopyToPublishDirectory="PreserveNewest" />
			</ItemGroup>

		</When>
	</Choose>                                                                                            
</Project>
